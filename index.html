<!doctype html>
<html xmlns="http://www.w3.org/1999/html">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>AWS Presentation</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<link rel="icon" href="/dist/assets/favicon.ico">

	</head>
	<style>
		.left {
			text-align: left;
		}
	</style>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-background-image="dist/assets/background/aws-gray.jpg">
					<h2>Match & Link Processor</h2>
					<br>
					<br>
					<p>
						<small>Prepared by <strong>Kareem Aljabr</strong></small>
					</p>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<h3>Introduction</h3>
					<p>
						At <a href="https://www.universalorlando.com/" target="_blank">Universal Orlando Resort</a> guests can have either a profile or an account.
					</p>
					<p style="text-align: left">A <span style="color: yellow">profile</span> is created when you:</p>
					<ul>
						<li class="fragment">Buy a ticket and <span style="color: yellow">checkout</span> as a guest</li>
						<li class="fragment">Book a hotel room and <span style="color: yellow">checkout</span> as a guest</li>
						<li class="fragment">Buy a ticket at the <span style="color: yellow">Theme Park</span> gate</li>
						<li class="fragment">Taking a <span style="color: yellow">survey</span> in the park</li>
						<li class="fragment"><span style="color: yellow">Sign up</span> for emails</li>
					</ul>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<h3>Introduction Count.</h3>
					<br>
					<p style="text-align: left">An <span style="color: yellow">account</span> is created when you:</p>
					<ul style="">
						<li class="fragment">Sign up using the <span style="color: yellow">website</span> or <span style="color: yellow">mobile</span> app</li>
						<li class="fragment"><span style="color: yellow">Checkout</span> as a guest then provide a password to create an account</li>
						<li class="fragment">Click create account link in a <span style="color: yellow">Ticket confirmation email</span></li>
					</ul>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<h3>What is Match & Link?</h3>
					<br>
					<ul>
						<li class="fragment">
							<span style="color: yellow">Asynchronous</span> process (worker)
						</li>
						<li class="fragment">
							<span style="color: yellow">Consumes Kafka</span> events <span class="fragment"><span style="color: yellow">produced</span> by guest profile service.</span>
						</li>
						<li class="fragment">
							When a profile is <span style="color: yellow">created or updated</span> it searches for a matching profile.
						</li>
						<li class="fragment">
							If a <span style="color: yellow">matching</span> profile is found, both profiles will be <span style="color: yellow">linked</span> if one of the matching <span style="color: yellow">rules</span> is achieved .
						</li>
					</ul>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>Core Concept - Scenario 1</h3>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>

						<div data-animate data-src="dist/assets/match-link-scenarios/orphan_match_link.svg" style="height: 70%;width: 70%;margin: auto;">
							<!--
                            { "setup": [
                            { "element": "#step_1", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "0"} ] },
                            { "element": "#step_2", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "1"} ] },
                            { "element": "#step_3", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "2"} ] },
                            { "element": "#step_4", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "3"} ] },
                            { "element": "#step_5", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "4"} ] },
                            { "element": "#step_6", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "5"} ] }
                            ]}
                            -->
						</div>
					</section>
					<section>
						<h3>Core Concept - Scenario 2</h3>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>

						<div data-animate data-src="dist/assets/match-link-scenarios/orphan_match_link_parent.svg" style="height: 70%;width: 70%;margin: auto;">
							<!--
                            { "setup": [
                            { "element": "#step_1", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "0"} ] },
                            { "element": "#step_2", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "1"} ] },
                            { "element": "#step_3", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "2"} ] },
                            { "element": "#step_4", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "3"} ] },
                            { "element": "#step_5", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "4"} ] }
                            ]}
                            -->
						</div>
					</section>
					<section>
						<h3>Core Concept - Scenario 3</h3>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>
						<span class="fragment"></span>

						<div data-animate data-src="dist/assets/match-link-scenarios/orphan_match_link_child.svg" style="height: 70%;width: 70%;margin: auto;">
							<!--
                            { "setup": [
                            { "element": "#step_1", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "0"} ] },
                            { "element": "#step_2", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "1"} ] },
                            { "element": "#step_3", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "2"} ] },
                            { "element": "#step_4", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "3"} ] },
                            { "element": "#step_5", "modifier": "attr", "parameters": [ {"class": "fragment", "data-fragment-index": "4"} ] }
                            ]}
                            -->
						</div>
					</section>

				</section>
				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>History ‚è≥</h3>
						<br>
						<p>
							Existing Node.js microservice, <span style="color: yellow">ms-guest</span>, used to proxy SOAP requests to an <span style="color: yellow">IBM MDM AE</span>.
						</p>
						<br>
						<p>
							<small>
								<a href="https://www.ibm.com/downloads/cas/PAA9NDJ9" target="_blank">IBM InfoSphere MDM AE</a> : IBM InfoSphere Master Data Management Advanced Edition
							</small>
						</p>
						<aside class="notes">
								MDM AE: Delivers data matching, data exploration and visualization for business users
						</aside>
					</section>
					<section>
						<h3>Issues</h3>
						<br>
						<ul>
							<li class="fragment">
								written by a team of developers from IBM, whose contracts were <span style="color: red">terminated</span>.
							</li>
							<li class="fragment">
								Lack of <span style="color: yellow">documentation</span>.
							</li>
							<li class="fragment">
								Difficult to maintain due to low <span style="color: yellow">unit test</span> coverage. And lack of <span style="color: yellow">integration tests</span>.
							</li>
							<li class="fragment">
								<span style="color: yellow">Loose</span> API contracts
							</li>
							<li class="fragment">
								<span style="color: yellow">Multiple</span> endpoints with the <span style="color: yellow">same functionality</span>.
							</li>
							<li class="fragment">
								<span style="color: yellow">DB</span> models CRUD operations endpoints <span style="color: yellow">exposed</span>.
							</li>
						</ul>
						<aside class="notes">
							<p>
								Replaced by a bunch of contractors and employees. due to restructuring and cutting cost reasons.
							</p>
							<p>
								json payload is not consistent, mobile, web, park and other services call it with different payload format.
							</p>
						</aside>
					</section>

					<section>
						<h3>Issues Cont.</h3>
						<br>
						<ul>
							<li class="fragment">
								Many <span style="color: yellow">performance</span> issues in <span style="color: yellow">production</span>.
							</li>
							<li class="fragment">
								Synchronous <span style="color: yellow">Match & Merge</span>
							</li>
							<li class="fragment">
								Poor design. An <span style="color: yellow">unregistered guest profile</span> is created whenever you land on the website.
							</li>
							<li class="fragment">
								Resulted in creating 100 millions of <span style="color: yellow">ghost profiles</span>.
							</li>
							<li class="fragment">
								<span style="color: yellow;">IBM</span> support contract is too <span style="color: yellow">expensive</span>.
							</li>
						</ul>
						<aside class="notes">
							<p>
								Match & Merge is part of the MDM AE service that used to happen real time when the profile is created or updated.
							</p>
						</aside>
					</section>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>Existing Solution Revamp</h3>
						<br>
						<p>Component Diagram Stages</p>
						<br>
						<ul>
							<li>
								<span style="color: yellow">Existing</span> Architecture
							</li>
							<li>
								<span style="color: yellow">Suggested</span> Architecture
							</li>
							<li>
								<span style="color: yellow">Proxy</span> existing service to new service
							</li>
							<li>
								Introducing <span style="color: yellow">Kafka</span>
							</li>
						</ul>
					</section>
					<section>
						<h4>Existing Architecture</h4>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/component/mdm-ae.svg" alt="mdm ae old" style="height: 500px"/>
						</div>
						<aside class="notes">
							<p>
								As I mentioned earlier we had many issues with this design
							</p>
							<p>
								The synchronous M&M. Adding new features to MDM AE was challenging. Production issues due to performance especially on event days.
							</p>
						</aside>
					</section>
					<section>
						<h4>Suggested Architecture</h4>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/component/mdm-ae-retire.svg" alt="mdm ae old" style="height: 500px"/>
						</div>
						<aside class="notes">
							<p>
								<small>We faced many challenges trying to implement this design right away as our <span style="color: yellow">clients</span>
									had no bandwidth to work on <span style="color: yellow">rewriting</span> their <span style="color: yellow">apps</span>
									to point to our new service. With completely new endpoints and different requests and responses.</small>
							</p>
							<p>
								<small>As you can see <span style="color: yellow">Match & Link is a service (API)</span> that is <span style="color: yellow">synchronously</span> called by guests service</small>
							</p>
						</aside>
					</section>
					<section>
						<h4>Proxy to New Service</h4>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/component/mdm-ae-proxy.svg" alt="mdm ae old" style="height: 500px"/>
						</div>
						<aside class="notes">
							<p>
								<small><span style="color: yellow">rewire the old service</span>
									to point to the <span style="color: yellow">new service</span>. So our <span style="color: yellow">clients don't</span>
									need to make changes to their codebase immediately.</small>
							</p>
							<p>
								<small>Found out <span style="color: yellow">gaps</span>
									in the new service <span style="color: yellow">design & implementation</span>.
									Like <span style="color: yellow">missing functionalities</span> or not required ones.</small>
							</p>
							<p>
								<small>Wrote <span style="color: yellow">automation tests</span> for the old service.
								Integrated them with the<span style="color: yellow"> CI/CD pipeline</span> to make sure we are not breaking current functionality.
									Or in other words to ensure <span style="color: yellow">backward compatibility</span>.</small>
							</p>
						</aside>
					</section>
					<section>
						<h4>Component Diagram - Kafka</h4>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/component/mdm-ae-kafka.svg" alt="mdm ae old" style="height: 500px"/>
						</div>
						<aside class="notes">
							<p>
								<small><span style="color: yellow">Asynchronous process</span>
									using <span style="color: yellow">Kafka</span>.</small>
							</p>
							<p>
								<small><span style="color: yellow">Guests Service</span>
									is independent of <span style="color: yellow">match & Link process</span>.</small>
							</p>
							<p>
								<small><span style="color: yellow">Data Lake</span>
									consumes link events.</small>
							</p>
						</aside>
					</section>
				</section>
				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>Sequence Diagram - Initial</h3>
						<div style="margin: auto;">
							<img class="r-stretch" src="dist/assets/diagrams/sequence/match-link-initial.svg" alt="mdm ae old" style="height: 550px"/>
						</div>
					</section>
					<section>
						<h3>Guests Service Performance Issues</h3>
						<p><small>I noticed <span style="color: yellow">high CPU</span> and <span style="color: yellow">Memory Usage</span> in <span style="color: yellow">Guests Service</span> when <span style="color: yellow">Match & Link</span> processor was launched</small></p>
						</br>
						<ul>
							<li class="fragment">
								Due to <span style="color: yellow">high number</span> of search matching profiles calls.
							</li>
							<li class="fragment">
								I <span style="color: yellow">redesigned</span> the <span style="color: yellow">solution</span> to add a <span style="color: yellow">read only</span> DB replica.
							</li>
						</ul>
					</section>
					<section>
						<h3>Sequence Diagram - Read DB</h3>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/sequence/match-link-read-db.svg" alt="mdm ae old" style="height: 550px"/>
						</div>
					</section>
				</section>
				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h4>Guests Dashboard</h4>
						<br>
						<p>
							I created a <span style="color: yellow">UI Dashboard</span> to help both <span style="color: yellow">QA</span> and <span style="color: yellow">Business</span> teams test and validate the <span style="color: yellow">Match & Link</span> process.
						</p>
						<aside class="notes">
							<p>
								We had issues related to writing automation tests to validate Match & Link results. Since it's Asynchronous process.
							</p>
							<p>
								At that time I was listening to podcasts and one guest was talking about Vue JS. I decided to learn it. I found creating this dashboard
								a motivation for me to learn it.
							</p>
							<p>
								Deployed on Github. Pages to save money and push code faster.
							</p>
						</aside>
					</section>
					<section>
						<h4>Create a Profile</h4>
						<video data-autoplay loop src="dist/assets/guests-dashboard/guests_dashboard_create_guest_profile.mp4" height="570px"></video>
					</section>
					<section>
						<p>
							<img src="dist/assets/guests-dashboard/create_guest_profile.png" alt="create guest profile" style="max-width: 100%;height: auto;">
						</p>
						<aside class="notes">
							Create a guest profile to validate matching a linking results.
						</aside>
					</section>
					<section>
						<h4>Select an Alternative Name</h4>
						<p><small>Select available <span style="color: yellow">Alternative name</span> for the given first name to test <span style="color: yellow">fuzzy</span> matching</small></p>
						<p>
							<img src="dist/assets/guests-dashboard/alt_names_feature.png" alt="create guest profile" style="max-width: 100%;height: auto;">
						</p>
						<aside class="notes">
							Added a feature to select available alt. names for the given firstName to test the fuzzy match.
						</aside>
					</section>
					<section>
						<h4>Primary Address</h4>
						<small><span style="color: yellow">Primary address</span> details to validate address matching rules</small>
						<img src="dist/assets/guests-dashboard/create_guest_profile_cont.png" alt="create guest profile" style="max-width: 100%;height: auto;">
						<aside class="notes">
							We scroll further down we have the primary address section.
						</aside>
					</section>
					<section>
						<h4>View Created Profile</h4>
						<video data-autoplay loop src="dist/assets/guests-dashboard/guests_dashboard_orphan_profile.mp4" height="570px"></video>
					</section>
					<section>
						<h4>Orphan Profile</h4>
						<small><span style="color: yellow">Orphan profile</span>, is a profile with no links to other profiles</small>
						<img src="dist/assets/guests-dashboard/find_orphan_profile.png" alt="find orphan profile">
						<aside class="notes">
							Click on find tab to retrieve the profile you created, and validate the match & link outcome.
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link</h4>
						<video data-autoplay loop src="dist/assets/guests-dashboard/guests_dashboard_validate_link.mp4" height="570px"></video>
					</section>
					<section>
						<h4>Validate Match & Link</h4>
						<small>Two profiles are <span style="color: yellow">linked</span>, forming a <span style="color: yellow">parent child relationship</span></small>
						<img src="dist/assets/guests-dashboard/find_parent_one_linked.png" alt="find one linked profile">
						<aside class="notes">
							It might take a few seconds to see the matching result since it's an asynchronous process.
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link Cont.</h4>
						<small><span style="color: yellow">Multiple</span> child profiles <span style="color: yellow">linked</span> to the same <span style="color: yellow">parent</span> profile.</small>
						<img src="dist/assets/guests-dashboard/find_parent_profile_two_linked.png" alt="find two linked profiles">
						<aside class="notes">
							If you go ahead and create a 3rd profile matching the parent you'd see that in the search result here.
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link Cont.</h4>
						<small><span style="color: yellow">Expand</span> any profile for more details</small>
						<img src="dist/assets/guests-dashboard/expand_parent_profile.png" alt="expand parent profile">
						<aside class="notes">
							<p>
								You can expand any profile listed here to see more details.
							</p>
							<p>
								We use Experian to standardize addresses to help with matching
							</p>
							<p>
								Standardizing the address happens in the background and data is saved on the marketing document and it's not shared with
								the guest. There is a score for standardized address when we call experian and we take the highest score if it's 90+%
							</p>
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link Cont.</h4>
						<small><span style="color: yellow">Child</span> profiles have more details about the <span style="color: yellow">matching result</span>.</small>
						<img src="dist/assets/guests-dashboard/expand_first_child.png" alt="expand child 1 profile">
						<aside class="notes">
							Here this profile matched the parent profile thru EMAIL_COMBO_1 matching rule.
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link Cont.</h4>
						<img src="dist/assets/guests-dashboard/expand_second_child.png" alt="expand child 2 profile">
						<aside class="notes">
							Here this profile matched the parent profile thru PHONE_COMBO_1 matching rule.
						</aside>
					</section>
					<section>
						<h4>Validate Match & Link Cont.</h4>
						<small><span style="color: yellow">Update profile</span> to trigger <span style="color: yellow">match & link</span> on update event</small>
						<img src="dist/assets/guests-dashboard/edit_guest_profile.png" alt="edit parent profile">
						<aside class="notes">
							You can also edit a profile to validate the update scenario
						</aside>
					</section>
				</section>
				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>Deployment</h3>
						<p><small>Existing <span style="color: yellow">CI/CD</span> pipeline was built using <span style="color: yellow">IBM Urbancode tools</span></small></p>
						<ul>
							<li class="fragment">
								<span style="color: yellow">Auto-scaling</span> was not an option. There is <span style="color: yellow">manual</span> work involved to create a <span style="color: yellow">new instance</span>.
							</li>
							<li class="fragment">
								All <span style="color: yellow">CI/CD configurations</span> were managed by <span style="color: yellow">Devops</span> team. Nothing was accessible to developers.
							</li>
						</ul>
					</section>
					<section>
						<h3>Existing Deployment Diagram</h3>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/deployment/existing-deployment.svg" alt="existing deployment" style="height: 500px"/>
						</div>
					</section>
				</section>

				<section data-background-image="dist/assets/background/black_chalk.jpg">
					<section>
						<h3>Future Enhancements</h3>
						<h4>Debezium</h4>
						<ul>
							<li class="fragment">
								<span style="color: yellow">Debezium</span> continuously monitors your <span style="color: yellow">databases</span> and lets any of your applications <span style="color: yellow">stream every row-level</span> change in the same order they were <span style="color: yellow">committed to the database</span>.
							</li>
							<li class="fragment">
								<span style="color: yellow">Debezium</span> is built on top of <span style="color: yellow">Apache Kafka</span>, which is proven, <span style="color: yellow">scalable</span>, and handles very <span style="color: yellow">large volumes of data</span> very quickly.
							</li>
						</ul>
						<aside class="notes">
							<p><small>Why do we need a services that <span style="color: yellow">update the database</span> to <span style="color: yellow">send notifications</span> and <span style="color: yellow">publish messages</span></small></p>
							<p><small>Doing that correctly - especially when things go wrong - is really tough, and if you get it wrong the data in those system may become inconsistent.</small></p>
						</aside>
					</section>
					<section>
						<h3>Future Enhancements</h3>
						<h4>In-Memory Cache</h4>
						<ul>
							<li class="fragment">
								Use <span style="color: yellow">In-Memory Cache</span> to mitigate the <span style="color: yellow">load on DB</span>.
							</li>
							<li class="fragment">
								<span style="color: yellow">Amazon ElastiCache</span> supports the <span style="color: yellow">Memcached</span> and <span style="color: yellow">Redis</span> cache engines. For <span style="color: yellow">simple</span> data models we can go for memcached. Redis handles <span style="color: yellow">complex</span> data types and many other features.
							</li>
						</ul>
						<aside class="notes">
							<p><small></small></p>
							<p><small></small></p>
							<p><small></small></p>
						</aside>
					</section>
					<section>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/component/mdm-ae-debezium.svg" alt="component diagram enhancement" style="height: 600px"/>
						</div>
					</section>
					<section>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/sequence/match-link-enhancement.svg" alt="sequence diagram enhancement" style="height: 600px"/>
						</div>
					</section>
					<section>
						<h4>Move to AWS</h4>
						<div style="margin: auto;">
							<img src="dist/assets/diagrams/deployment/aws_future_deployment.svg" alt="aws future"/>
						</div>
					</section>
				</section>
				<section data-auto-animate data-background-image="dist/assets/background/questions.jpg">
					<h1>Questions?</h1>
				</section>
				<section data-auto-animate data-background-image="dist/assets/background/questions.jpg">
					<h1>Questions?</h1>
					<h2>Time</h2>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/animate/plugin.js"></script>
		<script src="plugin/animate/svg.min.js"></script>
		<script src="plugin/zoom/zoom.js"></script>

		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				pdfSeparateFragments: false,
				// Add your config here:
				// transition: 'convex',
				transitionSpeed: 'slow',        // slow down slide transitions
				controlsTutorial: false,        // turn off arrow bumping
				// controlsLayout: 'edges',        // default 'bottom-right'
				 //controlsBackArrows: 'visible',  // make previous slide arrow bright instead of faded
				progress: true,
				center: true,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealAnimate, RevealZoom ]
			});
		</script>
	</body>
</html>
